<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Contracts.js Documentation</title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href='http://fonts.googleapis.com/css?family=Lato:100' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="style/sweetprism.css">
  <script type='text/javascript'>
  window.onload = function() {
  	document.body.className = "language-javascript";
  	Prism.highlightAll();
  }
  </script>
  <link href='style/prism.css' rel='stylesheet' />
  <script src="style/prism.js"></script>
  <style>
  body {
    margin: 0;
    padding: 0;
  }
  
  body {
    width: 600px;
    margin: 0 auto;
    position: relative;
    top: 75px;
  }
  
  #logo {
    float: left;
    width: 275px;
  }
  
  #content {
    float: left;
    width: 650px;
    padding-bottom:50px;
  }
  
  h1,h2,h3 {
    font-family: Helvetica Neue;
    font-weight: 100;
    color: #222;
    position: relative;
    text-transform: uppercase;
    color: #444;
    font-family: 'Lato', Helvetica Neue, Helvetica, Arial, sans-serif;
    font-weight: 100;
    border-bottom: solid 1px #eee;
  }
  h1 {
    font-size: 200%;
  }
  h2 {
    font-size: 150%;
  }
  h3 {
    font-size: 120%;
  }
  
  p, li {
    font-family: 'Source Sans Pro', sans-serif;
    /*font-weight: 400;*/
    font-size: large;
  }
  
  
  p code {
    font-size: 14px;
  }
  li code {
    font-size: 14px;
  }
  
  a {
  	text-decoration: none;
  }
  a:hover, a:focus {
      text-decoration: underline;
  }
  
  .editor { display : none }
  
  /* to display output of macro expansions */
  .console {
    -moz-border-radius: 6px;
    -webkit-border-radius: 6px;
    border-radius: 6px;
    padding: 1em;
    margin-top:1em;
    white-space: pre;
    background: #f5f2f0;
    resize: vertical;
    max-height: 700px;
    overflow: auto;
    font-family: Consolas, Monaco, "Andale Mono", monospace;
    text-shadow:0 1px white;
    display:none;
  }
  
  </style>
</head>
<body>
<header>
<h1 class="title">Contracts.js Documentation</h1>
</header>
<nav id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#installation"><span class="toc-section-number">2</span> Installation</a></li>
<li><a href="#using"><span class="toc-section-number">3</span> Using</a></li>
<li><a href="#contracts"><span class="toc-section-number">4</span> Contracts</a></li>
<li><a href="#faq"><span class="toc-section-number">5</span> FAQ</a><ul>
<li><a href="#do-i-have-to-use-macros"><span class="toc-section-number">5.1</span> Do I have to use macros?</a></li>
<li><a href="#what-is-up-with-the-import"><span class="toc-section-number">5.2</span> What is up with the import?</a></li>
</ul></li>
</ul>
</nav>
<h1 id="introduction"><span class="header-section-number">1</span> Introduction</h1>
<p>Contracts.js is a contract library for JavaScript that allows you to specify invariants between parts of your code and have them checked at runtime for violations.</p>
<h1 id="installation"><span class="header-section-number">2</span> Installation</h1>
<p>Requires <a href="http://sweetjs.org">sweet.js</a> which you can install via npm:</p>
<pre><code>npm install -g sweet.js
npm install contracts.js</code></pre>
<h1 id="using"><span class="header-section-number">3</span> Using</h1>
<p>At the top of your file you will need to use some special syntax to import contracts.js:</p>
<pre class="js"><code>import @ from &quot;contracts.js&quot;

// rest of your code goes here...</code></pre>
<p>This looks like ES6 modules but it's not really and will work with whatever module system you are using (if any). See <a href="#what-is-up-with-the-import">here</a> for details.</p>
<p>Compile your JavaScript file with sweet.js using the contracts.js module:</p>
<pre><code>sjs --module contracts.js -o output.js input.js</code></pre>
<p>Then run your <code>output.js</code> file in any JavaScript environment. Some features of contracts.js (proxied objects and arrays) require ES6 features which not every JavaScript engine supports right now (any recent version of Firefox is fine along with node.js/V8 with the <code>--harmony</code> flag enabled).</p>
<h1 id="contracts"><span class="header-section-number">4</span> Contracts</h1>
<p>Put a contract on a function like this:</p>
<pre class="js"><code>@ (Num) -&gt; Num
function id(x) {
    return x;
}


id(&quot;a string&quot;);
/*
Error: id: contract violation
expected: Num
given: &#39;a string&#39;
in: the 1st argument of
    (Num) -&gt; Num
blaming: (calling context for id)
*/</code></pre>
<h1 id="faq"><span class="header-section-number">5</span> FAQ</h1>
<h2 id="do-i-have-to-use-macros"><span class="header-section-number">5.1</span> Do I have to use macros?</h2>
<p>No, as a matter of fact. If you'd like to just use the library in vanilla JavaScript you can. Load contracts.js and then use the <code>guard</code> function:</p>
<pre class="js"><code>var id = guard(fun([Num], Num),
               function id(x) { return x; },
               &quot;id&quot;);</code></pre>
<h2 id="what-is-up-with-the-import"><span class="header-section-number">5.2</span> What is up with the import?</h2>
<pre class="js"><code>import @ from &quot;contracts.js&quot;</code></pre>
<p>The short answer is that it's a hack until sweet.js provides proper module support.</p>
<p>This line is actually a macro that expands into contracts.js library code that each contracted function will refer to.</p>
</body>
</html>
